@model DragonGame.Models.Character
@{
    ViewData["Title"] = "Your Character";
}

<h2>Your Character</h2>

<div class="avatar" style="position: relative; width: 400px; height: 400px; margin: 2rem auto 3rem auto;">
    <img id="poseImage"
         src="@(Model.Pose != null ? "/images/poses/" + Model.Pose.ImageUrl : "/images/base.png")"
         alt="@(Model.Pose?.Name ?? "Base")"
         style="position:absolute; width:100%; height:100%;" />

    <img id="hair" src="/images/hair/@Model.Hair" alt="Hair" style="position:absolute; width:100%; height:100%;" />
    <img id="face" src="/images/faces/@Model.Face" alt="Face" style="position:absolute; width:100%; height:100%;" />
    <img id="outfit" src="/images/clothes/@Model.Outfit" alt="Outfit" style="position:absolute; width:100%; height:100%;" />
</div>

<form asp-action="UpdateCharacterPose" asp-controller="Character" method="post">
    @Html.AntiForgeryToken()
    <input type="hidden" asp-for="Id" />

    <select id="poseDropdown" asp-for="PoseId" asp-items="ViewBag.PoseOptions" class="form-control">
        <option value="">Select a pose</option>
    </select>

    <!-- Hidden inputs for hair, face, outfit -->
    <input type="hidden" id="hairInput" name="Hair" value="@Model.Hair" />
    <input type="hidden" id="faceInput" name="Face" value="@Model.Face" />
    <input type="hidden" id="outfitInput" name="Outfit" value="@Model.Outfit" />

    <button type="submit" class="btn btn-primary mt-2">Change Pose</button>
</form>

<form>
    <div class="row justify-content-center mt-4">
        <div class="col-auto">
            <button type="submit" class="btn btn-primary">Save Character</button>
        </div>
    </div>
</form>

<form asp-action="Delete" method="post">
    @Html.AntiForgeryToken()
    <input type="hidden" name="id" value="@Model.Id" />
    <button type="submit" class="btn btn-danger">Restart</button>
</form>

@section Scripts {
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script>
        var initialCharacterData = {
            id: @Model.Id,
            poseId: @(Model.PoseId.HasValue ? Model.PoseId.Value.ToString() : "null"),
            hair: "@Model.Hair",
            face: "@Model.Face",
            outfit: "@Model.Outfit"
        };
    </script>
    <script src="~/js/poseSelector.js"></script>
    <script src="/js/CharacterCreator.js"></script>
}
